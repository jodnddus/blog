---
title: "테이블 뷰 개발 과정"
date: "2020-08-01"
description: "테이블 뷰 개발하면서 생긴 일들"
categories: [devlog]
comments: true
---

포켓서베이의 보고서 기능에는 단일 응답에 대한 정보를 얻기가 힘들다는 단점이 있다. 그래서 우리 조직의 운영 매니저분들은 단일 응답(로우 데이터)을 확인하실 때 매번 엑셀로 다운로드 받아서 확인하신다. 이렇게 매번 다운로드 받아서 데이터를 확인하는 것이 불편해서 별도 기능으로 개발하기로 했다. 그래서 정해진 프로젝트의 이름은 `테이블 뷰` 프로젝트이다.

구글 폼이나 네이버 폼에서는 개별 응답을 아래 사진처럼 실제 설문 페이지에 응답이 표시되는 방법으로 보여주고 있다.

![구글 폼 개별 응답 보고서](/static/images/googleformindividualview.png)

포켓서베이에는 이런 식으로 작동하는 개별보고서 기능이 있는데, 이 기능과는 별개로 각 응답을 리스트로, 테이블로 확인하고 싶다는 고객의 니즈로 인해 테이블로 각 응답을 보여줄 수 있는 기능을 만들었다.

원래는 각 설문 응답 건을 테이블 형태로 보여주는 간단한 기능을 만드는 것으로 알고 있었는데, 기획서가 완성되고 보니까 개발해야 할 부가적인 기능들이 좀 있었다. 이 글에서는 각 기능 별 구현할 때 고민이 되었던 점과 그 고민을 어떻게 해결했는지를 다룰 것이다.

![완성본](/static/images/tableviewmockeddata.png)

### 설문의 버전과 상관없이 모든 응답이 테이블에 나와야 함.

포켓서베이의 설문에는 `버전` 이라는 단위가 존재한다. 그때 그때의 설문 구조를 버전으로 관리하는데 이렇게 되면 당연히 그 버전에 따라서 응답 데이터가 다르게 들어올 것이다. 예를 들어 1버전 설문에는 A, B, C 문항이 있고 2버전 설문에는 A, B, F, G 문항이 있다면 버전 별로 다른 응답 구조가 생길 것이다. 요런 식으로 말이다.

| 응답자 | 1-A | 1-B | 1-C | 2-A | 2-B | 2-F | 2-G |
| ------ | --- | --- | --- | --- | --- | --- | --- |
| 철수   | 1   | 5   | 4   |     |     |     |     |
| 영희   |     |     |     | 1   | 4   | 5   | 7   |

이렇게 테이블이 표시된다면 보기 힘들 정도로 열이 많아질 것이다. 그래서 버전끼리 열의 equality를 비교해서 중복을 없애주는 작업을 했다.

| 응답자 | A   | B   | C   | F   | G   |
| ------ | --- | --- | --- | --- | --- | --- | --- |
| 철수   | 1   | 5   | 4   |     |     |     |     |
| 영희   | 1   | 4   |     | 5   | 7   |

이렇게 만들어진 헤더 리스트(A,B,C,F,G)를 originHeaderList라고 이름 지었다.

현재 개발 스코프에서는 열의 equality를 비교해서 중복을 없애 주었지만 문항의 의미를 분석할 수 있는 딥러닝 모델을 만들어서 적용한다면 참 좋을 것 같다. 😎

### 열 자동 키워드화 기능

"응답자의 이름을 입력해 주세요" 나 "영어 이름을 입력해 주세요" 같은 문항에 대한 응답을 테이블 뷰에서 보여줄 때는 자동으로 이름1, 이름2 라는 열 이름을 구성하는 기능이다.

### 기준 열 자동 감지 기능

이번 프로젝트에서는 테이블에서 가장 좌측에 위치하는 열을 기준열이라고 부른다. 기준이 되는 열을 자동으로 만들어주면, 테이블을 보는 사람이 그 기준을 가지고 각 row를 비교하며 볼 수 있기 때문에 편리하다.
이 기준열이 되려면 아래 조건 중 하나를 충족해야 한다.

1. metadata에 이름이 있는 경우
2. 주관식 문항 이름에 이름, 회사명, 서비스명이 존재하는 경우
3. 주관식 문항 이름에 연락처이 존재하는 경우
4. 주관식 문항 이름에 URL이 존재하는 경우
5. 주관식 문항 이름에 UID이 존재하는 경우

이 기능을 만들 땐 `기준열을 뽑아주는 함수`, `열의 위치를 바꾼 뒤 바뀐 열 리스트를 리턴하는 함수` 이 두 함수의 조합으로 기능을 구현했다. 예전의 나였다면 `기준 열 자동 감지 함수`로 기능을 한 함수에 몰아서 구현했을 것이다. 이런 식으로 작은 기능 단위로 쪼개서 구현했더니 훨씬 추상적인 방식으로 개발이 가능했고. 이는 자연스럽게 코드에 대한 커뮤니케이션을 수월하게 만드는 결과를 만들었다.

![함수의 조합](https://i.pinimg.com/originals/4f/97/1b/4f971b0d6bacdd50c85333a2af80ddaf.gif)

### 필터, 정렬 부가 기능

이번 프로젝트는 React Table이라는 라이브러리를 이용해서 개발하였다. 이 라이브러리가 되게 많은 기능을 제공하고 있는데, 이번 프로젝트에서는 필터, 글로벌 필터, 정렬, 열 순서 변경, 열 숨김 정도로만 사용을 했다. 되게 간편해서 docs만 보고 개발이 가능하니 테이블이 필요한 분들은 이 라이브러리를 사용하면 좋을 것 같다.

[React Table](https://react-table.tanstack.com/docs/overview)

---

### 회고

이번 프로젝트는 총 두 명이 진행하였다. 그러면서 작업 플로우에 대한 고민을 조금 더 실험적으로 가져갈 수 있게 되었다. 제일 먼저 `작업 명세서 작성`이라는 단계를 도입하였다.

#### 작업 명세서 작성

평소에는 대표님이 써주시는 기획서를 토대로 작업 계획을 잡고 작업에 관한 회의를 했다. 하지만 이 부분에서 미스 커뮤니케이션이 종종 생겼는데, 내가 생각한 원인은 아래와 같다.

##### 기획서의 내용이 흐름이 있지 않고 산발적임.

개발자가 작업을 할 때는 어떠한 흐름이 있어야 한다고 생각한다. 그런 맥락에서 필요한 기능들만 산발적으로 써져있는 기획서를 보며 개발을 하려니까 잘 이해가 되지 않는 부분이 많았다. 그래서 생각한 방안은 실제 작업 담당자가 기획서를 보면서 나름대로의 시나리오대로 개발 계획을 세우는 것이다. 이 단계를 거치면 기획서를 완전히 숙지할 수 있고 기획자의 의도도 알아차릴 수 있을뿐더러, “내가 작업을 어떻게 진행할 것이다~”라는 메시지도 될 수 있다. 이렇게 되면 미연에 미스 커뮤니케이션을 방지할 수도 있다.

그다음으로 실험한 작업 플로우는 `작은 PR 실천하기`이다.

#### 작은 PR 실천하기

이 부분은 코드 리뷰 도입에 관련된 블로그 글에서 심심찮게 찾아볼 수 있는 내용이다. 많은 개발자가 알고 있는 내용이지만, 쉽게 도입하지는 못하는 내용이라고 생각한다. 우리 개발 조직도 그랬다. "diff를 최소한으로 만들어서 하나하나 다 리뷰하자"라는 뉘양스의 이야기는 내가 많이 하지만, 실제로 지켜지지는 않았다.

이번 프로젝트에서는 투입 인원이 적어서 그런지 diff 리뷰가 참 잘 되었다. 어떤 이슈가 있으면 그 이슈에 따라서 하위 브랜치를 만들고 그 하위 브랜치에서 작업한 뒤 바로 PR을 만들어서 리뷰를 진행하는 플로우가 아주 잘 지켜졌다. 이것이 잘 지켜진 이유는 위에서 언급한 작업 명세에 따른 작업 쪼개기가 참 잘 되었기 때문이다.

#### 결과

이런 플로우 덕분인지 기능 개발 후 진행하는 인수 테스트에서 전 기능 개발 프로젝트 대비 이슈가 대폭 떨어졌다고 테스트를 진행하시는 대표님이 말씀해 주셨다. 참 뿌듯했고 내가 말한 대로 작업을 잘 따라와 주신 동료 개발자에게 감사 인사를 전한다. 😁

![이슈로 작업 진행하기](table-view-issue.png)

나는 이 작업 플로우에 대해서 조금 더 검토할 예정이고, 조금 더 다듬어서 우리 개발 조직의 문화로 정착시킬 계획이다.
